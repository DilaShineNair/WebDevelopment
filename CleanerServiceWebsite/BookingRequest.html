<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Match Maid - Booking Request</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="" name="keywords">
  <meta content="" name="description">

  <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Montserrat:300,400,500,700"
    rel="stylesheet">

  <!-- Bootstrap CSS File -->
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Libraries CSS Files -->
  <link href="lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="lib/animate/animate.min.css" rel="stylesheet">
  <link href="lib/ionicons/css/ionicons.min.css" rel="stylesheet">
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">

  <!-- Main Stylesheet File -->
  <link href="css/style.css" rel="stylesheet">


</head>

<body id="page-top">

  <!--==========================
  Header
  ============================-->
  <header id="header" class="fixed-top">
    <div class="container">
	
      <div class="main-nav logo float-left">
	  <ul style="list-style-type: none">
        <!-- Uncomment below if you prefer to use an image logo -->
        <!-- <h1 class="text-light"><a href="#header"><span>NewBiz</span></a></h1> -->
        <li><a href="#intro" class="scrollto"><img src="img/logo.png" height=200px width=150px alt="" class="img-fluid"></a></li>
		<li><a class="nav-link" id="FullName" style="font-size: 18pt"></a></li>
	  </ul></div>

      <nav class="main-nav float-right d-none d-lg-block">
        <ul>
		
          <li class="active">
            <div class="dropdown">
              <button class="dropbtn"><a href="indexClient.html">Home</a></button>
              <div class="dropdown-content">
                <a href="indexClient.html#about">About Us</a>
                <a href="indexClient.html#services">Services</a>
                <a href="indexClient.html#why-us">Why Us</a>
                <a href="indexClient.html#portfolio">Portfolio</a>
                <a href="indexClient.html#testimonials">Testimonials</a>
                <a href="indexClient.html#contact">Contact Us</a>
              </div>
            </div>
          </li>

          <li><a href="BookingRequest.html">Booking</a></li>
          <li><a href="BookingHistory.html">Booking History</a></li>
          <li><a href="Profile.html">Profile</a></li>
          <li><a href="index.html" action="firebase.auth().signOut();" id="signOut">Sign Out</a></li>
        </ul>
      </nav><!-- .main-nav -->

    </div>
  </header><!-- #header -->


  <!--Profile Table-->
  <section id="request">
    <div class="container">
      <br><br>
      <br><br>
      <form action="">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <form id="requestForm" method="post" action="indexClient.html">
            <h1 class="text-center text-uppercase text-secondary mb-0">Booking</h1>
            <br><br>
            <p>
              <div class="control-group">
                <div class="form-group floating-label-form-group controls mb-0 pb-2">
                  <label>Name</label>
                  <input class="form-control" type="text" placeholder="Enter name" name="name" id="txtName" required>
                </div>
              </div>
            </p>
            <p><div class="control-group">
                <div class="form-group floating-label-form-group controls mb-0 pb-2">
                    <label>Phone Number</label>
                    <input class="form-control" name="phone" id="Phone1" type="tel" placeholder="Phone Number" required>
                </div>
            </div></p>
            <p><div class="control-group">
                <div class="form-group floating-label-form-group controls mb-0 pb-2">
                    <label>Email</label>
                    <input class="form-control" name="email" id= "Email1" type="email" placeholder="Email" required>
                </div>
            </div></p>
            
            <p><div class="control-group">
                <div class="form-group floating-label-form-group controls mb-0 pb-2">
                        <label>How many cleaning hours do you required?</label><br>
						<label for="session2">
						<input type="radio" name="service" required value="session2" id="session2" /> 
						2 Hours Session
						</label>
						&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
						<label for="session3">
						<input type="radio" name="service" required value="session3" id="session3" /> 
						3 Hours Session 
						</label>
						&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
						<label for="session4">
						<input type="radio" name="service" required value="session4" id="session4" /> 
						4 Hours Session
						</label>
                    </div>
            </div></p>
            <p><div class="control-group">
                <div class="form-group floating-label-form-group controls mb-0 pb-2">
                    <label>Date</label>
                    <input class="form-control" name="cleaningDate" id= "Date1" type="date" required>
                    <label>Time</label>
                    <input class="form-control" name="cleaningTime" id= "Time1" type="time" required>
                </div>
              </div></p>
              
              <p><div class="control-group">
                  <div class="form-group floating-label-form-group controls mb-0 pb-2">
                      <label>Address</label>
                      <input class="form-control" name="address" id= "Address1" type="text" rows="2" placeholder="Address" required>
                  </div>
              </div></p>
     
              <p><div class="control-group">
                  <div class="form-group floating-label-form-group controls mb-0 pb-2">
                      <label>Special Instructions :</label>
                      <textarea class="form-control" name="comments" id = "Comments1" rows="4" placeholder="Tell us if you have any special requests."></textarea>
                  </div>
              </div></p>

              <p><div class="control-group">
                <div class="form-group floating-label-form-group controls mb-0 pb-2">
                  <br><br>
                  <button type="button" id="checkPrice">Check Price</button>
                  <p id="planPrice"></p>
                </div>
              </div></p>
            
        </form>
            <form>
                <div class="custom-file">
                  <input type="file" class="custom-file-input" id="file">
                  <label class="custom-file-label" for="customFile" id="fileMessage">Choose your profile</label>
                </div>
                <br>
                <div id="divProfile">
                    <img src="" alt="Profile" class="img-thumbnail" id="profile">
              </div>
              </form>
              

              
            
            
            <br><br>


            <div class="form-group">
              <button type="button" class="btn btn-primary btn-xl"id="submitbooking" >Submit Booking</button>
              <button type="reset" class="btn btn-primary btn-xl">Clear</button>
            </div>
          </form>
          <br><br>
        </div>
      </div>
    </form>
    </div>
  </section>

  <!--Profile Table-->
  <!--==========================
    Footer
  ============================-->
  <footer id="footer">
    <div class="footer-top">
      <div class="container">
        <div class="row">

          <div class="col-lg-4 col-md-6 footer-info">
            <h3>Match Maid</h3>
            <p> Match Maid is a a cleaning company that make hiring a cleaning service as simple as possible for you as
              our customer.
              We are truly dedicated to providing you with exceptional services at reasonable rates and simplify your
              life by taking the house cleaning off your to do list.</p>
          </div>

          <div class="col-lg-2 col-md-6 footer-links">
            <h4>Useful Links</h4>
            <ul>
              <li><a href="#about">About Us</a></li>
              <li><a href="#why-us"> why Us</a></li>
              <li><a href="#services">Services</a></li>
              <li><a href="#">Terms of service</a></li>
              <li><a href="#">Privacy policy</a></li>
            </ul>
          </div>

          <div class="col-lg-3 col-md-6 footer-contact">
            <h4>Contact Us</h4>
            <p>
              1441, Jln Seksyen 1/4, Bandar Barat, 31900 Kampar, Negeri Perak<br>
              <strong>Phone:</strong> +6014 984 6055<br>
              <strong>Email:</strong> appli1778@gmail.com<br>
            </p>

            <div class="social-links">
              <a href="#" class="twitter"><i class="fa fa-twitter"></i></a>
              <a href="#" class="facebook"><i class="fa fa-facebook"></i></a>
              <a href="#" class="instagram"><i class="fa fa-instagram"></i></a>
              <a href="#" class="google-plus"><i class="fa fa-google-plus"></i></a>
              <a href="#" class="linkedin"><i class="fa fa-linkedin"></i></a>
            </div>

          </div>

          <div class="col-lg-3 col-md-6 footer-newsletter">
            <h4>Our Newsletter</h4>
            <p>Subscribe us and u will get news daily</p>
            <form action="" method="post">
              <input type="email" name="email"><input type="submit" value="Subscribe">
            </form>
          </div>

        </div>
      </div>
    </div>

    <div class="container">
      <div class="copyright">
        &copy; Copyright <strong>Match Maid</strong>. All Rights Reserved


      </div>
  </footer><!-- #footer -->

  <a href="#" class="back-to-top"><i class="fa fa-chevron-up"></i></a>
  <!-- Uncomment below i you want to use a preloader -->
  <!-- <div id="preloader"></div> -->

  <!-- JavaScript Libraries -->
  <script src="lib/jquery/jquery.min.js"></script>
  <script src="lib/jquery/jquery-migrate.min.js"></script>
  <script src="lib/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/mobile-nav/mobile-nav.js"></script>
  <script src="lib/wow/wow.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/counterup/counterup.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="lib/isotope/isotope.pkgd.min.js"></script>
  <script src="lib/lightbox/js/lightbox.min.js"></script>
  <!-- Contact Form JavaScript File -->
  <script src="contactform/contactform.js"></script>

  <!-- Template Main Javascript File -->
  <script src="js/main.js"></script>
<script type="text/javascript">
    // Animations initialization
    new WOW().init();
  </script>

  <!--Firebase-->
<script src="https://www.gstatic.com/firebasejs/6.3.4/firebase.js"></script>
<script src="Accountfirebase.js"></script>
   <script>
    var file;

    $(function () {//onload
	
	    $( "#txtName" ).focus();
	    initApp();
		
			
		$("#errorMessage").hide();
		$("#divProfile").hide();
	   
	    $('#file').on("change", function(evt){ 
		  
		     evt.stopPropagation();
             evt.preventDefault();
             file = evt.target.files[0];
			 
			 $("#fileMessage").text(file.name);
			 

		  });
		  
		  
		  $("#submitbooking").click(function (e) {
          
   		    var txtName = $("#txtName").val();
          
		  
		   $("#errorMessage").html("");
		   $("#errorMessage").hide();
		  
		  var error = false;
					
	       if (txtName.length ==0) 
		   {
               $("#errorMessage").html("Please enter your name. <br/>");
			    error= true;
           }
			
			
           if ($("input[type=file]").val()==""){
		       $("#errorMessage").append("Please select your profile. <br/>");
			   error= true;
           }
			
			
			if(error)
			{
			   $("#errorMessage").show();
			   return;
			}
			
			
          
		   var metadata = {
              'contentType': file.type
            };
			
			
			
						
		     var storageRef = firebase.storage().ref();
			 
		     storageRef.child('users-profile/' + firebase.auth().currentUser.uid).put(file, metadata).then(function(snapshot) {
              
			snapshot.ref.getDownloadURL().then(function(downloadURL) {
                      $("#divProfile").show();
			   
                      $("#profile").attr("src",downloadURL);
					  
					  var user = firebase.auth().currentUser;
					  
					  
			         //updateProfile
                     user.updateProfile({
			         displayName: txtName,
                     photoURL: downloadURL 
                     }).then(function() {
					 
					 
					    //Add user data into Firestore
						var obj = new Object();
                        obj.Email = $("#Email1").val();
                        obj.DisplayName = $("#txtName").val();
                        obj.phonenumber = $("#Phone1").val();
                        obj.date = $("#Date1").val();
                        obj.time = $("#Time1").val();
                        obj.Comments = $("#Comments1").val();
                        obj.Address = $("#Address1").val();
                        obj.Cleaninghour = $("#op1").val();
                        obj.Cleaninghour = $("#op2").val();
                        obj.Cleaninghour = $("#op3").val();
				        obj.Photo=downloadURL;
				        obj.Uid = firebase.auth().currentUser.uid;
				        obj.DateTime = firebase.firestore.FieldValue.serverTimestamp();
				  
				        //alert(JSON.stringify(obj));
				  
				        var db = firebase.firestore();
				       // Add a new document in collection "Users"
                      db.collection("Bookinginfo").doc(firebase.auth().currentUser.uid).set(obj).then(function() {
						
						alert("Profile uploaded successfully.");
					window.location.href = "indexClient.html";
					 
                  })
                  .catch(function(error) {
                       $("#errorMessage").html(error.message);
					   
					 
                  });
			                 
                     }, function(error) {
                      // An error happened.
			          //  var errorCode = error.code;
                     // var errorMessage = error.message;
			   
			           $("#errorMessage").show();
			           $("#errorMessage").html(errorMessage);
			    
                    });
            });
			
			
				       
		    }).catch(function(error) {
             // [START onfailure]
			
			  $("#errorMessage").show();
			   $("#errorMessage").html("Upload failed: "+ error);
             
            // [END onfailure]
            });
           // [END oncomplete]

        });
		
		$("#ResetPassword").click(function (e) {
			window.location.href = "resetPassword.html";
		});

    });
	
	
	
	function initApp() {
	   //check user keep in cookie
      // Listening for auth state changes.
      // [START authstatelistener]
       firebase.auth().onAuthStateChanged(function(user) {
       
        if (user==null) 
           window.location.href = "SignIn.html";
		else
		{
		   if(user.displayName!=null)
		   {
		      $("#FullName").html("Welcome " + user.displayName);
		      $("#txtName").val(user.displayName);
		    }
		    
           if(user.photoURL != null)
           {		   
		      $("#divProfile").show();
				   
              $("#profile").attr("src",user.photoURL);
		   }
		
		}
 
      });
      // [END authstatelistener]
	  }
</script>

  <script>
  $(function () {//onload
   $("#signOut").click(function (e) {
      firebase.auth().signOut();
   });
  });
</script>


</html>